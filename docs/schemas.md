# Guidelines for Defining Schemas and Types

All types and schemas must be defined in `src/schemas` directory, following `entity-name.schema.ts` pattern. Each type must be defined using Zod schema and the typescript type must be infered from the Zod schema. We should export both the schema and the type. For example:

```ts
import { z } from "zod";

export const noteSchema = z.object({
  id: z.string(), // Primary key for the Note record
  content: z.string(),
  createdAt: z.date().optional(), // Set by DB/service, present on retrieved entities
  updatedAt: z.date().optional(), // Set by DB/service, present on retrieved entities
});

export type NoteType = z.infer<typeof noteSchema>;
```

Place related types/schemas in the same file. For example, place Data Access Objects (DAO) schema and types in the same file:

```ts
export const createNoteSchema = noteSchema
  .omit({
    id: true, // Will be generated by the service/system
    createdAt: true, // Will be set by the service/database
    updatedAt: true, // Will be set by the service/database
  })
  .extend({
    // Ensure 'content' is explicitly required as it's min(1) in base schema but omit might make it optional
    content: z.string().min(1, "Note content is required for creation."),
  });
export type CreateNoteType = z.infer<typeof createNoteSchema>;

// For updates, 'id' is typically part of the URL, not the body.
// The DTO should only contain fields that can be changed.
export const updateNoteSchema = noteSchema
  .omit({
    id: true,
    createdAt: true,
    updatedAt: true,
  })
  .partial(); // All fields become optional for updates
export type UpdateNotetype = z.infer<typeof updateNoteSchema>;
```

Place shared types/schema in `src/schemas/shared.schema.ts`. For example:

```ts
// Base Query Parameters Schema
export const queryParamsSchema = z.object({
  search: z.string().optional(),
  sortBy: z.string().optional(),
  sortOrder: z.enum(["asc", "desc"]).optional(),
  page: z.coerce.number().int().positive().optional(),
  limit: z.coerce.number().int().positive().optional(),
});

export type QueryParamsType = z.infer<typeof queryParamsSchema>;
```

## Guidelines for Defining and Using Environment Variables

All environment variables must be defined and validated (through Zod) in the `src/env.ts` and imported from this file to other files.

When adding new environment variables, make sure to document them in `.env.example`.
